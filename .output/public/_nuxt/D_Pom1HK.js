import{f as g,r as d,g as f,h as k,c as x,a as e,i as u,j as b,v as _,k as w,l as U,o as S}from"./CDjqcE0o.js";const B=e("label",{for:"email"},"Email",-1),C=["value"],O=e("label",{for:"username"},"Username",-1),V=e("label",{for:"website"},"Website",-1),A=["value","disabled"],D=["disabled"],j={__name:"Account",async setup(E){let r,m;const c=g(),a=d(!0),n=d(""),i=d(""),p=d("");a.value=!0;const v=f(),{data:o}=([r,m]=k(()=>c.from("profiles").select("username, website, avatar_url").eq("id",v.value.id).single()),r=await r,m(),r);o&&(n.value=o.username,i.value=o.website,p.value=o.avatar_url),a.value=!1;async function h(){try{a.value=!0;const s={id:f().value.id,username:n.value,website:i.value,avatar_url:p.value,updated_at:new Date},{error:l}=await c.from("profiles").upsert(s,{returning:"minimal"});if(l)throw l}catch(t){alert(t.message)}finally{a.value=!1}}async function y(){try{a.value=!0;const{error:t}=await c.auth.signOut();if(t)throw t;v.value=null}catch(t){alert(t.message)}finally{a.value=!1}}return(t,s)=>(S(),x("form",{class:"form-widget",onSubmit:U(h,["prevent"])},[e("div",null,[B,e("input",{id:"email",type:"text",value:u(v).email,disabled:""},null,8,C)]),e("div",null,[O,b(e("input",{id:"username",type:"text","onUpdate:modelValue":s[0]||(s[0]=l=>w(n)?n.value=l:null)},null,512),[[_,u(n)]])]),e("div",null,[V,b(e("input",{id:"website",type:"url","onUpdate:modelValue":s[1]||(s[1]=l=>w(i)?i.value=l:null)},null,512),[[_,u(i)]])]),e("div",null,[e("input",{type:"submit",class:"button primary block",value:u(a)?"Loading ...":"Update",disabled:u(a)},null,8,A)]),e("div",null,[e("button",{class:"button block",onClick:y,disabled:u(a)},"Sign Out",8,D)])],32))}};export{j as default};
